"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2244],{2244:function(e,r,t){t.r(r),t.d(r,{RenderPromises:function(){return i},getDataFromTree:function(){return getDataFromTree},getMarkupFromTree:function(){return getMarkupFromTree},renderToStringWithData:function(){return renderToStringWithData}});var n=t(7582),o=t(7294),s=t(5317),i=function(){function RenderPromises(){this.queryPromises=new Map,this.queryInfoTrie=new Map,this.stopped=!1}return RenderPromises.prototype.stop=function(){this.stopped||(this.queryPromises.clear(),this.queryInfoTrie.clear(),this.stopped=!0)},RenderPromises.prototype.registerSSRObservable=function(e){this.stopped||(this.lookupQueryInfo(e.options).observable=e)},RenderPromises.prototype.getSSRObservable=function(e){return this.lookupQueryInfo(e).observable},RenderPromises.prototype.addQueryPromise=function(e,r){return this.stopped||this.lookupQueryInfo(e.getOptions()).seen?r?r():null:(this.queryPromises.set(e.getOptions(),new Promise(function(r){r(e.fetchData())})),null)},RenderPromises.prototype.addObservableQueryPromise=function(e){return this.addQueryPromise({getOptions:function(){return e.options},fetchData:function(){return new Promise(function(r){var t=e.subscribe({next:function(e){e.loading||(r(),t.unsubscribe())},error:function(){r(),t.unsubscribe()},complete:function(){r()}})})}})},RenderPromises.prototype.hasPromises=function(){return this.queryPromises.size>0},RenderPromises.prototype.consumeAndAwaitPromises=function(){var e=this,r=[];return this.queryPromises.forEach(function(t,n){e.lookupQueryInfo(n).seen=!0,r.push(t)}),this.queryPromises.clear(),Promise.all(r)},RenderPromises.prototype.lookupQueryInfo=function(e){var r=this.queryInfoTrie,t=e.query,n=e.variables,o=r.get(t)||new Map;r.has(t)||r.set(t,o);var s=JSON.stringify(n),i=o.get(s)||{seen:!1,observable:null};return o.has(s)||o.set(s,i),i},RenderPromises}(),u=t(7762);function getDataFromTree(e,r){return void 0===r&&(r={}),getMarkupFromTree({tree:e,context:r,renderFunction:u.renderToStaticMarkup})}function getMarkupFromTree(e){var r=e.tree,t=e.context,a=void 0===t?{}:t,p=e.renderFunction,c=void 0===p?u.renderToStaticMarkup:p,f=new i;return Promise.resolve().then(function process(){var e=(0,s.K)();return new Promise(function(t){t(c(o.createElement(e.Provider,{value:(0,n.pi)((0,n.pi)({},a),{renderPromises:f})},r)))}).then(function(e){return f.hasPromises()?f.consumeAndAwaitPromises().then(process):e}).finally(function(){f.stop()})})}function renderToStringWithData(e){return getMarkupFromTree({tree:e,renderFunction:u.renderToString})}}}]);